#Tooltips will be generated from these rules when they fail. Use of custom_tooltip is recommended
#There are still multiple hard-coded rules that apply in addition to these.
#If rules here evaluate to true, there might still be other rules that make the action unavailable.
#If a rule here evaluates to false the action will become unavailable

# This = country

# 抄袭舰女人的
###_[swg][gsf][fq]	##################
###_[swg/gsf/azl/fq]	##################
# This = country
can_build_branch_offices = {
	custom_tooltip = {
		fail_text = BRANCH_OFFICE_NOT_MEGACORP
		#_+wsg/gsf/fq
		OR = {
			has_authority = auth_corporate
			has_civic = civic_galactic_sovereign_megacorp
			has_authority = auth_warshipgirls		#_wsg
			has_civic = civic_gk			#_gsf
			has_civic = civic_business_union		# ark商业联合
			has_authority = auth_azur_lane_0		#_azl
			has_authority = auth_azur_lane_1		#_azl
			has_authority = auth_azur_lane_2		#_azl
			has_valid_civic = civic_mutualistic_behavior	#_fq
		}
	}
}


###_[swg/gsf/azl/zofe/sofe]	##################
# This = country
can_support_branch_offices = {
	#_ZOFE
	OR = {
		is_country_type = default
		is_country_type = ascended_empire
	}
	custom_tooltip = {
		fail_text = BRANCH_OFFICE_NOT_FALLEN_EMPIRES
		NOR = {
			is_country_type = fallen_empire
			is_country_type = awakened_fallen_empire
		}
	}
	is_regular_empire = yes
	NOR = {
		has_authority = auth_corporate
		has_authority = auth_warshipgirls			#_wsg
		has_civic = civic_gk				#_gsf
		has_civic = civic_business_union			# ark商业联合
		has_authority = auth_azur_lane_1			#_azl
		has_valid_civic = civic_sofe_inner_strength		#_SOFE
	}
}


###_[swg/azl/hfe/fq]	##################
# This = planet
# Root = country
can_build_branch_office_on_planet = {
	#_swg
	custom_tooltip = {
		fail_text = requires_recipient_not_warshipgirls
		exists = owner
		owner = {
			OR = {
				NOT = { has_authority = auth_warshipgirls }
			}
		}
	}	
	custom_tooltip = {
		fail_text = requires_recipient_not_fanatic_purifiers
		exists = owner
		owner = {
			OR = {
				is_same_species = root
				NOT = { has_civic = civic_fanatic_purifiers }
			}
		}
	}
	#_	+fq/swg/azl
	custom_tooltip = {
		fail_text = BRANCH_OFFICE_NOT_COMMERCIAL_PACT
		exists = owner
		OR = {
			root = { is_criminal_syndicate = yes }
			owner = { has_commercial_pact = root }
			owner = { is_in_federation_with = root }
			root = {  has_valid_civic = civic_mutualistic_behavior }	#_fq
			root = { has_authority = auth_azur_lane_1 }		#_azl

			# allow branch offices in subsidiaries and vice versa
			root = {
				is_subject = yes
				is_subject_type = subsidiary
				overlord = { is_same_value = owner }
			}
			owner = {
				is_subject = yes
				#_+swg
				OR = {
					is_subject_type = subsidiary
					overlord = { has_authority = auth_warshipgirls }	#_swg
				}
				overlord = { is_same_value = root }
			}
			#_hfe
			AND = {
				has_global_flag = hfe_installed
				root = { overlord = { is_country = prevprev.owner } }	#_this的owner
			}
			#_azl
			AND = {
				has_authority = auth_azur_lane_2
				owner = { is_same_empire = root }
			}
			AND = {
				root = { has_civic = civic_galactic_sovereign_megacorp }
				owner = { is_galactic_community_member = yes }
			}
			AND = {
				root = { has_modifier = imperial_charter }
				owner = { is_galactic_community_member = yes }
			}
		}
	}
	#_	+azl
	custom_tooltip = {
		fail_text = BRANCH_OFFICE_CRIMINAL_HERITAGE_HAS_TRUCE
		exists = owner
		OR = {
			root = {
				is_criminal_syndicate = no
				NOT = { has_authority = auth_azur_lane_1 }	#_azl
			}
			owner = {
				NOR = {
					has_truce = root
					is_at_war_with = root
				}
			}
		}
	}
	#_	+azl
	custom_tooltip = {
		fail_text = BRANCH_OFFICE_CRIMINAL_COOLDOWN
		exists = owner
		OR = {
			root = {
				is_criminal_syndicate = no
				NOT = { has_authority = auth_azur_lane_1 }	#_azl
			}
			AND = {
				root = { is_criminal_syndicate = yes }
				NOT = { has_planet_flag = criminal_branch_closed_cooldown_planet@root }
			}
		}
	}
}